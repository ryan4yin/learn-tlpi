# 文件加锁

文件加锁主要是**用于避免多个进程同时读写同一个文件的情况**，但作为一种锁机制，它同样也可用于更通用的需要加锁的场景。


## 使用 flock() 给文件加锁

flock() 可以对一整个文件加锁，它的控制粒度是「文件」。

```c
#include <sys/file.h>

int flock(int fd, int operations);
```

TODO

### 锁继承与释放的语义

TODO


### flock() 的限制

TODO


## 使用 fcntl 给记录枷锁

fcntl() 能够在一个文件的任意部分上放置一把锁，它的粒度更细，可以小到一个字节，也可以大到一整个文件。

使用示例：

```c

```

fnctl() 加锁的类型：

TODO



