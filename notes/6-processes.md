# 进程

## 进程内存布局

- 文本段
- 初始化数据段
- 未初始化数据段
  - 出于历史原因, 未初始化数据段也称为 BSS 段
- 栈
- 堆

## 虚拟内存管理

Linux 内核通过虚拟内存管理来实现进程间的内存隔离.

虚拟内存管理是指, 操作系统为每个进程提供一个独立的虚拟地址空间, 使得每个进程都认为自己独占整个内存空
间. 而在物理内存中, 操作系统利用了 CPU 提供的 MMU (Memory Management Unit) 来实现虚拟地址到物理地址
的高效映射.

为了更高效地分配内存, 操作系统将物理内存划分为多个页 (Page), 并以页为单位进行内存分配.

物理内存的分页实际也由 CPU 的 MMU 实现的, 因此页的大小视具体的 CPU 架构而定. 在 x86-32 架构下, 页的
大小固定为 4KB, 而在 x86-64 架构下, 页的大小默认为 16KB, 并可调整.

> 对于需要大量内存的应用, 也可以使用 Linux 的大页 (Huge Page) 来减少系统调用, 提升程序性能. 在 x64
> 架构下,大页的大小通常为 2MB.

### CPU 与 MMU

是否具有 MMU (Memory Management Unit) 是 MCU (Microcontroller Unit) 和能跑 Linux 的 MPU 的显著区别之
一.

不带有 MMU 的 MCU 只能运行裸机程序或者 RTOS, 其中的程序直接访问物理地址. 而带有 MMU 的 MPU 可以运行
Linux 操作系统, 其中的程序访问的是虚拟地址, 由 MMU 负责将虚拟地址转换为物理地址.
